<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>EMAdownload_introduction • EMAdownload</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EMAdownload_introduction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EMAdownload</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/EMA-lookup-tables.html">EMA lookup tables</a></li>
    <li><a class="dropdown-item" href="../articles/EMAdownload_introduction.html">EMAdownload_introduction</a></li>
    <li><a class="dropdown-item" href="../articles/join_event_catch_guide.html">Join Event Catch Examples</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>EMAdownload_introduction</h1>
            
      

      <div class="d-none name"><code>EMAdownload_introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette serves as an introduction the generalized structure of
Ecosystem Monitoring and Assessment (EMA) data sets. The goal of this
package is to allow users an easy way to filter and query EMA’s data
sets in a reproducible way with access to the most up-to-date versions
of the data sets.</p>
<p>One of the difficulties of utilization of EMA’s data sets is that
there is a lot of nuance and institutional knowledge required to curate
a usable data set for a users individual purpose. Survey designs are
catered to given ecosystem monitoring goals and thus survey sampling
designs can vary markedly across the time series. This vignette will
provide a brief overview of the most important nuances that users should
be aware of when working with these data sets. There will be individual
vignettes for each function that outline them in more thorough
detail.</p>
<hr>
<div class="section level3">
<h3 id="data-structure-overview">Data Structure Overview<a class="anchor" aria-label="anchor" href="#data-structure-overview"></a>
</h3>
<p>EMA’s database utilizes a hierarchical structure, with parent records
being each individual sampling event, and child records being data
values collected from those sampling events. The event table utilizes a
primary key composed of three fields: <strong>station_id, event_code,
and gear</strong>. In all cases, when joining child data records with
parent event records, the join should be done on those three fields
(station_id, event_code, and gear). When dealing with catch and fish
data specifically, catch records have parent event records, while
individual fish records (length/weight) have parent catch records.
<strong>You can link fish records directly to their event records, but
for data validation, the parent/child relationship is established with
the catch table (thus ensuring you do not have fish records at a station
where you do not have a catch record for that fish).</strong></p>
<p>The database itself has a wealth of look-up tables for codes that are
stored within the data tables utilized in this package. Many of these
codes should be intuitive to the user. The Taxonomic Serial Number (tsn)
lookup table is directly provided in the package within the EMA look-up
tables vignette. This table is required because species identifications
are stored as a numerical key, so to add common name and scientific name
to your data files, this is included. Please note that the fish tsn
look-up table is separate from the zooplankton species tsn look-up and
zooplankton stage code look-up.</p>
<hr>
<div class="section level4">
<h4 id="eventevent-parameters-table-overviews">Event/Event Parameters Table Overviews<a class="anchor" aria-label="anchor" href="#eventevent-parameters-table-overviews"></a>
</h4>
<p>The event and event parameter tables are two tables that contain
event sampling information collected during sampling or calculated after
sampling has occurred. Each table uses a primary key of
<strong>station_id, event_code, and gear</strong>. That means each
sampling event at each station ID with each gear has a single record (to
clarify, there are situations where at each station_id+event_code,
multiple gears are deployed simultaneously, i.e. Bongo &amp; CAT).
Whenever you are curating a data set, there are many considerations that
should be given to the fields outlined below to ensure you are not
including or excluding records that may not belong in your analysis.</p>
<div class="section level5">
<h5 id="gear-and-tow_type">Gear and tow_type<a class="anchor" aria-label="anchor" href="#gear-and-tow_type"></a>
</h5>
<p>For trawl derived data: the gear and tow_type fields are two of the
most critical fields to have a good understanding of for filtering data.
In almost all circumstances, it is never appropriate to compare catch
values across tow types given their differences in both area of water
column sampled and in how the trawl is fished (e.g., a surface trawl
(tow_type: S) samples a different habitat than an oblique tow (tow_type:
O)). Similarly, it usually not appropriate to compare different gears
(see gear_description), at least to the extent reasonably possible.
Often times, gears fish significantly different enough that their catch
efficiencies (i.e. mesh diameters, cod-end mesh diameters) make them
mostly incomparable. This means that users looking to curate a specific
data set need to be keenly aware of both of these fields. A recommended
best practice is to start as wide as possible including as many trawl
methods and gears to capture your area of interest, and then pairing
that data set down appropriately to follow the rules outlined above.</p>
<p>Generally speaking, most users will be most interested in surface
trawl data sets as a starting point, given those tows are most
consitently sampled across our timeseries. However, users should consult
the tow_type lookup table, as well as the Gear lookup tables, to ensure
they are querying all of the tows that meet their criteria for
analysis.</p>
</div>
<div class="section level5">
<h5 id="gear-performance">Gear Performance<a class="anchor" aria-label="anchor" href="#gear-performance"></a>
</h5>
<p>The three values for this field are S (satisfactory), G (good), and Q
(questionable). Generally speaking, questionable records are completely
appropriate to use. It generally indicates that something part of the
gear did not operate perfectly during fishing, however it was deemed
insignificant enough to remove the tow. U (unsatisfactory) and A
(aborted) tows are removed in these package functions during data
querying so they are not included in these data sets and users should
not recieve events that were U or A.</p>
</div>
<div class="section level5">
<h5 id="haul-dates-and-times">Haul Dates and Times<a class="anchor" aria-label="anchor" href="#haul-dates-and-times"></a>
</h5>
<p>Dates and times are in GMT.</p>
</div>
<div class="section level5">
<h5 id="latitudelongitude-descriptors">Latitude/Longitude descriptors<a class="anchor" aria-label="anchor" href="#latitudelongitude-descriptors"></a>
</h5>
<p>There are several latitude and longitude fields that are included
with the standard event table. And their exact application is dependent
on the trawl method conducted. The exact applications are explained
below by tow type.</p>
<div class="section level6">
<h6 id="surface-and-midwater-trawls">Surface and Midwater Trawls<a class="anchor" aria-label="anchor" href="#surface-and-midwater-trawls"></a>
</h6>
<p>Gear In/Gear Out Latitude/Longitude: The lat/long where the gear
first enters or exists the water, respectively. These fields are
generally inconsequential for surface and midwater trawls as the net is
not considered “fishing” between Gear In and EQ, or between Haulback and
Gear Out.</p>
<p>EQ/Haulback Latitude/Longitude: EQ Lat/long is the point where the
net is fully deployed and considered “fishing”. Haulback Lat/Long is the
point where the trawl is considered completed and haulback of the net
begins. These are generally considered the start and end points for
these tow types and duration/distance/effort are calculated using these
two points.</p>
</div>
<div class="section level6">
<h6 id="oblique-trawls">Oblique Trawls<a class="anchor" aria-label="anchor" href="#oblique-trawls"></a>
</h6>
<p>Gear In/Gear Out Latitude/Longitude: The lat/long where the gear
first enters or exists the water, respectively. For oblique tows, the
net is considered fishing between these two points. Distance and
duration are calculated between these two points.</p>
<p>EQ/haulback Latitude/Longitude: EQ Lat/Long is the point where the
net reaches the lowest point of the oblique tow. Haulacbk Lat/Long is
the point where retrieval of the net from the lowest point begins. The
net often remains at the lowest point of the tow for a short duration.
These fields are generally inconsequential for oblique tows.</p>
</div>
</div>
<div class="section level5">
<h5 id="efforteffort-units">Effort/Effort Units<a class="anchor" aria-label="anchor" href="#efforteffort-units"></a>
</h5>
<p>Effort calculations differ by tow type, with surface and midwater
trawls using an area swept in square kilometers, while oblique tows use
a volume filtered in cubic kilometers.</p>
<p><strong>The calculation for effort for surface trawls</strong> is the
average horizontal net opening (km) multiplied by the haversine distance
(greater circle distance) between EQ lat/long and Haulback lat/long
(km).</p>
<p><strong>The calculation for effort for oblique trawls</strong> is a
calculation of the average net opening (km^2) as estimated by maximum
trawl wire out multiplied by the haversine distance of the tow between
Gear In lat/long and Gear Out lat/long (km).</p>
</div>
<div class="section level5">
<h5 id="nbs-stratabsierp-regionoceanographic-domainregion">NBS Strata/BSIERP Region/Oceanographic Domain/Region<a class="anchor" aria-label="anchor" href="#nbs-stratabsierp-regionoceanographic-domainregion"></a>
</h5>
<p>These are all classification fields that seek to group stations based
on area of sampling to allow for a more nuanced analysis. NBS Strata
groups stations sampled in the NBS by geographic area. Some strata are
excluded from most analysis due to infrequent sampling. Oceanographic
domain filters stations based on bathymetry and is primarily used for
stations in the southern Bering sea. BSIERP regions are a group of 16
marine regions of the Bering sea originally established by the Bering
Sea Integrated Research Program.</p>
<p>The region field seeks to classify each station further into the
generalized where sampling occurred. That is to say, when looking to
group stations large scale and finding natural survey break points,
these regions seek to do that and are done by a latitude classification.
<strong>Southeastern Bering sea (SEBS) is any station south of
59.9N</strong>. <strong>Northern Bering Sea (NBS) is any station between
59.9N and 65.5N</strong>, and <strong>Arctic is any station north of
65.5N</strong>. Gulf of Alaska (GOA) stations are classified only as
GOA.</p>
</div>
</div>
<div class="section level4">
<h4 id="catch-table-overview">Catch Table Overview<a class="anchor" aria-label="anchor" href="#catch-table-overview"></a>
</h4>
<p>Compared to event tables, catch table has less nuance. The table has
a primary key of station_id, event_code, gear, species_tsn, and
lhs_code. This means that for each species plus life history stage at
each sampling event, there is only a single record. There are only a few
notes for this table outlined below.</p>
<div class="section level5">
<h5 id="species-tsn">Species TSN<a class="anchor" aria-label="anchor" href="#species-tsn"></a>
</h5>
<p>These are numeric representations of scientific name and common name,
as found on ITIS[<a href="https://itis.gov/" class="external-link uri">https://itis.gov/</a>]. It should be noted that these codes
are <strong>not always 100% up-to-date</strong>, however the record
integrity of species names across the catch and fish tables are (i.e.,
it is a better practice to look up a specific species of interest from
the taxa data table (get_ema_taxonomy() or species tsn table in the
look-up vignette)) than it is to look the species up in ITIS, as
classifications are updated but these updates do not always reach our
taxonomy table. If a species catch record exists in our database, it
will be in our taxa table.</p>
</div>
<div class="section level5">
<h5 id="lhs-codes">LHS Codes<a class="anchor" aria-label="anchor" href="#lhs-codes"></a>
</h5>
<p>Life history stage codes are a somewhat <strong>arbitrary
classification based on historic sorting practices</strong> across the
time series for each given species. The life history assignments
assigned across the time series are quite consistent, however their
classification are not 100% verified by otolith work. Generally
speaking, for gadids, Age-0 (A0) is anything less than around 100mm. For
salmon, juveniles are considered any specimen under around 300mm. Users
who are interested in seeing the length variation of these should
examine the length/weight data for their species of interest to see how
this classification is applied across the time series. One recent change
that users should note, is the change in Pollock LHS classification (see
lhs look-up table). Previous to 2024, Pollock LHS were age-0, age 1+,
but beginning in 2024 field estimations of age-0, age-1, and age 2+ are
now being used.</p>
</div>
<div class="section level5">
<h5 id="subsamples">Subsamples<a class="anchor" aria-label="anchor" href="#subsamples"></a>
</h5>
<p>In almost all use cases, users should only be interested in the
total_catch_number and total_catch_weight fields from the catch table.
However, it is worth describing the significance of subsample values. In
records where the subsample_num/weight are identical to the
total_num/weight, that simply means that the entire haul was sorted. In
situations where they are different, it means the entire catch was
weighed, however only a portion of that catch was sorted, counted, and
re-weighed. Then, those counts and weights were applied to the total
weight to estimate total numbers and weights for each species.</p>
</div>
<div class="section level5">
<h5 id="catches">0-Catches<a class="anchor" aria-label="anchor" href="#catches"></a>
</h5>
<p>When building a data set, users will often be interested in stations
where a species was, and was not caught. But, because of the
hierarchical model our database uses, it is not a straightforward
process to query this. For users who are interested in these values,
this functionality has been built into the join_event_catch() function.
Use vignettes(join_event_catch_guide, package=“EMAdownload”) to see
examples of this.</p>
</div>
</div>
<div class="section level4">
<h4 id="fish-table-overview">Fish table overview<a class="anchor" aria-label="anchor" href="#fish-table-overview"></a>
</h4>
<p>The last data table that warrants an overview is the fish table. This
table contains all of the length, weight, and special studies collection
information for individuals collected and measured aboard the
survey.</p>
<div class="section level5">
<h5 id="salmon-maturity">Salmon Maturity<a class="anchor" aria-label="anchor" href="#salmon-maturity"></a>
</h5>
<p>When salmon are assigned a LHS designation, they are assigned either
immature, or juvenile. However, some maturing salmon are caught aboard
EMA surveys. Because, for the most part, they are less visually
identifiable, at the catch level these are the only two classifications
used for life history stage. However, as part of specimen processing,
these fish are sexed and assessed a maturity stage. That is assigned
here as either immature or maturing.</p>
</div>
<div class="section level5">
<h5 id="length-type">Length Type<a class="anchor" aria-label="anchor" href="#length-type"></a>
</h5>
<p>This field tracks the specific style of length measurements used for
the given species. For the most part, length measurement protocols have
not changed for a given species+life history, with one noteworthy
exception. <strong>In the early 2010s, there was a shift from measuring
lengths for age-0 gadids from TOTAL LENGTH to STANDARD LENGTH</strong>.
So users should be aware of this; Ben Laurel provided conversions for
Walleye pollock and Pacific cod (below) The conversions for Pollock
(Gadus chalcogrammus) in the 30-100 mm range are:</p>
<p>TL(mm) = -0.25145 +1.08123*SL(mm)</p>
<p>SL(mm) = 0.29353 + 0.92359*TL(mm)</p>
<p>The conversions for Pacific cod (Gadus macrocephalus) in the 30-100mm
range are</p>
<p>TL(mm) = 0.26250 + 1.0769*SL(mm)</p>
<p>SL(mm) = 0.06258 + 0.92843*TL(mm)</p>
</div>
<div class="section level5">
<h5 id="special-studies-fields">Special studies fields<a class="anchor" aria-label="anchor" href="#special-studies-fields"></a>
</h5>
<p>There are a large number of fields contained within this table that
are used internally for the flagging of specific studies that samples
are collected for. This includes otolith, scale, stomach, genetics, bomb
calorimetry, and isotope analysis. While these values are not stored in
our database, additional data sets containing this data are likely
available from the labs that have conducted these analyses. Please
contact package maintainers or EMA researchers to get contact
information for these data.</p>
</div>
<div class="section level5">
<h5 id="catch-weighting">Catch-Weighting<a class="anchor" aria-label="anchor" href="#catch-weighting"></a>
</h5>
<p>This is not a specific field in this table, but this seems the most
appropriate place to note this. Often times, when working with specimen
level data, it is often recommended that you consider weighting your
length data based on the total catch for that species+lhs at the given
sampling event. This is because regardless of how many of a given
specimen we catch at a station, we never measure more than the number of
individuals specified by the collection protocols for that species
(i.e. pollock may be 50 or 100, jellyfish may be 10). There is a
vignette available that details a method for doing this procedure
vignette(catch_weighting,package=“EMAdownload”).</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="ending-notes">Ending Notes<a class="anchor" aria-label="anchor" href="#ending-notes"></a>
</h3>
<p>The goal of this package was to introduce a simple tool to create
easily reproducible data sets from EMA’s database in an effort to both
expand use of EMAs data sets as well as give regular users a tool for
querying reproducible data sets containing the most up-to-date data
while being able to pull the data directly into R.</p>
<p>Given the high degree of nuance to the data set, there is a lot of
front-loaded information that users really should be aware of when
curating a data set for analysis. The default arguments for our
functions are set up in a way where a user should get a reasonably
functional data set for their species+lhs combinations of interest.</p>
<p>For any issues, please post them at <a href="https://github.com/afsc-ema/EMAdownload/issues" class="external-link uri">https://github.com/afsc-ema/EMAdownload/issues</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Domke Lia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
